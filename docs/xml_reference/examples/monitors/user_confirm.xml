<?xml version="1.0" encoding="UTF-8"?>

<!-- This example application shows the usage of user_confirm monitors. This monitor allows to wait for user input and to trigger events according to the input. Also see 'skill_user_confirm'
-->

<pitasc>

    <models>
        <include package="pitasc_library" file="models/pitasc.xml"/>
        <include package="pitasc_library" file="models/skills.xml"/>

        <include package="pitasc_library" file="universal_robots/ur.xml"/>
    </models>

    <clone prototype="project">

        <member id="configuration">
            <clone id="configuration" prototype="default_configuration"/>
        </member>

        <member id="environment">
            <clone prototype="robot_ur5">
                <member id="robot_driver.max_velocity">2.0</member>
                <member id="robot_driver.max_acceleration">3.0</member>
            </clone>
        </member>

        <!-- bool flag to disable user confirm monitors (see 'ignore' member)-->
        <clone id="release_mode" prototype="bool_parameter">True</clone>

        <member id="applications">
            <clone prototype="skill_sequence">

                <member id="robot" reference_id="environment.robot_ur5"/>

                <!-- Skills -->
                <member id="skills">

                    <!-- First move to start position -->
                    <clone prototype="skill_lin">
                        <member id="tool_frame">tool</member>
                        <member id="target_frame">start_position</member>
                    </clone>

                    <clone prototype="skill_user_confirm" />

                    <clone prototype="skill_lin">
                        <member id="tool_frame">tool</member>
                        <member id="target_frame">target1</member>
                    </clone>

                    <clone prototype="skill_user_confirm">
                        <member id="title">Caution!</member>
                        <member id="text">Clicking no will trigger an exception! Continue?</member>
                        <member id="reject_event">event123</member>                        <!-- clicking no will trigger an exception, since event "event123" does not exist -->
                    </clone>

                    <clone prototype="skill_cartesian_tracking">
                        <member id="tool_frame">tool</member>
                        <member id="target_frame">target2</member>
                        <member id="monitors">
                            <clone prototype="monitor_user_confirm">
                                <member id="title">Cartesian Tracking</member>
                                <member id="text">Do you want to succeed with next skill?</member>
                            </clone>
                        </member>
                    </clone>

                    <clone prototype="skill_lin">
                        <member id="tool_frame">tool</member>
                        <member id="target_frame">target1</member>
                    </clone>

                    <!-- will be ignored, since 'release_mode' is set to true -->
                    <clone prototype="skill_user_confirm">
                        <member id="ignore" reference_id="release_mode" />
                    </clone>

                    <clone prototype="skill_lin">
                        <member id="tool_frame">tool</member>
                        <member id="target_frame">target1</member>
                    </clone>

                </member>

            </clone>
        </member>

    </clone>

</pitasc>
